\documentclass{article}

\usepackage[dvips]{rotating,epsfig}
\usepackage{longtable}
\usepackage{overcite}
\usepackage{amstext}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{verbatim}
%\usepackage{afterpage}
\usepackage{mcite}
%\usepackage{psboxit}

%\PScommands

\special{papersize=8.5in,11in}
\setlength{\textwidth}{6.5in}
\setlength{\textheight}{9.0in}
\setlength{\hoffset}{-0.75in}
\setlength{\voffset}{-0.75in}

\special{papersize=8.5in,11.5in}

\newcommand{\wn}{cm$^{-1}$}
\newcommand{\XtildeE}{$\widetilde{X}\,^2$E\ }
\newcommand{\XtildeA}{$\widetilde{X}\,^2\!$A$_1$\ }
\newcommand{\AtildeE}{$\widetilde{A}\,^2$E\ }
\newcommand{\AtildeA}{$\widetilde{A}\,^2\!$A$_1$\ }
\newcommand{\ItildeA}{$\widetilde{I}^+\,^1\!$A$_1$\ }
\newcommand{\AadoubleXe}{\AtildeA $\leftrightarrow $ \XtildeE }
\newcommand{\AasingleXe}{\AtildeA $\leftarrow $ \XtildeE }
\newcommand{\IasingleAe}{\ItildeA $\leftarrow $ \AtildeE }
\newcommand{\ai}{{\it ab initio}}
\newcommand{\Xzero}{${\bf X_0}$}
\newcommand{\xone}{${\bf x_1}$}
\newcommand{\xtwo}{${\bf x_2}$}
\newcommand{\xd}{${\bf x_d}$}
\newcommand{\Xmin}{${\bf X_{\min }}$}
\newcommand{\Xmax}{${\bf X_{\max }}$}
\newcommand{\xmax}{${\bf x_{\max }}$}
\newcommand{\JT}{Jahn-Teller\ }
\newcommand{\Xa}{{\bf Xa}}
\newcommand{\Xb}{{\bf Xb}}
\newcommand{\Xc}{{\bf Xc}}
\newcommand{\ddelta}{d$\delta $}
\newcommand{\ddeltastar}{d$\delta ^*$}
\newcommand{\dsigma}{d$\sigma $}
\newcommand{\dsigmastar}{d$\sigma ^*$}
\newcommand{\dpi}{d$\pi $}
\newcommand{\dpistar}{d$\pi ^*$}
\newcommand{\ul}{\underline }
\renewcommand{\o}{CF$_3$O}
\newcommand{\s}{CF$_3$S}
\newcommand{\socjttwo}{\bf{SOCJT 2}}
\newcommand{\socjt}{{\bf SOCJT}}
\newcommand{\socrt}{{\bf SOCRT}}
\newcommand{\etoe}{{\bf e2e}}
\newcommand{\pitopi}{{\bf pi2pi}}

\newenvironment{bulletlist}{%
  \renewcommand{\labelitemi}{$\bullet $}%
     \begin{itemize}}{\end{itemize}}

\renewcommand{\baselinestretch}{1}

\setlength{\LTcapwidth}{6in}
\renewcommand{\marginparwidth}{0.5in}

\begin{document}

\author{Terrance Codd}
\title{Users Manual for \socjttwo}

\date{\today}

\maketitle

%\newpage
\tableofcontents
%\newpage
%\listoffigures
%\newpage
%\listoftables
\newpage

\setcounter{section}{-1}
\section{Preface} \label{section:preface}

The program \socjttwo\ has the following
capabilities: 
\begin{bulletlist}
\item Find the lowest energy solutions to the Jahn-Teller Hamiltonian, including linear and quadratic terms as well as bilinear coupling terms between Jahn-Teller active and inactive modes and cross-quadratic Jahn-Teller coupling between two degenerate modes, and spin-orbit coupling, for any molecule in a non-cubic point group.
%\item Compute a number of properties of the state using the eigenvectors, including Coriolis coupling constants and the relative vibronic transition intensities between the Jahn-Teller active state
%  and a non-degenerate state, or another Jahn-Teller active state.
\item Any number of Jahn-Teller active and inactive modes can be accommodated, as well as an arbitrary spin state, whether half-integer or integer.
\item A non-linear least squares routine is available for the fitting of the parameters to experimental data.
\item Generate scans of one or more parameters automatically.
\end{bulletlist}

\begin{comment}
The following files are included in the distribution file {\tt
  socjt.zip}: 
\begin{description}
\item[{\tt socjt.exe}] Executable file for the main program,
  \socjt, to be run from a MS-DOS prompt.
\item[{\tt socrt.exe}] Executable file for the Renner-Teller
  version, \socrt .
\item[{\tt e2e.exe}] Executable file for the calculation of
  electronic transition intensities from one \JT\ active state to
  another.
\item[{\tt pi2pi.exe}] Executable file for the calculation of
  electronic transition intensities from one Renner-Teller active
  state to another. This file is not yet available.
\item[{\tt inputasst.exe}] Executable file that creates an input
  file for {\tt socjt.exe } based on the answers to a series of
  questions.
\item[{\tt test1}] Plain text input file to test \socjt.
\item[{\tt test2}] Plain text input file to test \socjt. The output
  of the files {\tt test1} and {\tt test2} can be used as input for
  \etoe .
\item[{\tt rt\_test}] Plain text input file to test \socrt .
\item[{\tt e2e\_test}] Plain text input file to test \etoe .
\item[{\tt manual.tex, manual.ps, and manual.pdf}] The users guide for
  the suite of programs. 
\item[{\tt output.zip}] All of the output files that are generated by
  running the test files. 
\end{description}
\end{comment}

\newpage

\section{Introduction} \label{section:intro}

The Jahn-Teller effect is by now quite old and over a thousand papers
have been published on \JT\ related molecules.  While many of these
papers are on distortions of \JT\ molecules in solid-state crystal
structures, an ever increasing number of high resolution, gas-phase
measurements of \JT\ active states of molecules are being obtained in
the laboratory. The high quality of this data, free of perturbations
by extra-molecular interactions, has revealed the true complexity of
the \JT\ problem. Of particular importance to our research has been
the fact that nearly all \JT\ active states so far observed have been
open shell systems, which in principle all have first-order
spin-orbit coupling, except for the somewhat rare open shell singlet
states. It was the purpose of this research to develop a simple
to use, yet fairly complete, set of computer programs for the analysis of the
spectroscopic data for \JT\ molecules.

This manual describes the use and background of \socjttwo\ and is a modified version of the manual written for \socjt by Timothy A. Barckholtz and Terry A. Miller.
The program \socjttwo\ (an anacronym for {\ul S}pin-{\ul O}rbit {\ul C}oupling
and {\ul J}ahn-{\ul T}eller; pronounced ``sock-it'') diagonalizes the
spin-vibronic portion of the Jahn-Teller Hamiltonian, which produces
the energies and eigenvectors of the spin-vibronic levels of the
state.

\begin{comment}
Besides diagonalizing the spin-vibronic Hamiltonian, the programs
\socjt\ and \socrt\ calculate several properties of the system. All of
these properties are detailed later in section \ref{section:output}.
One of the most important items calculated by \socjt\ is the relative
intensities of the vibronic transitions involved in an electronic
transition to and from the degenerate state. These calculations assume
diagonal Franck-Condon factors, and only the intensities of
progressions of the Jahn-Teller active modes are computed. In the main
\socjt\ and \socrt\ programs, it is assumed that the non-Jahn-Teller
active state involved in the electronic transition is a singly
degenerate or non-Jahn-Teller active degenerate state.
\end{comment}

This program was written by Terrance Codd between 2011 and 2013 while
a graduate student at The Ohio State University, advised by Terry
Miller. It was written in C$\sharp$ and therefore requires either the .NET framework (Windows) or Mono (OSX and Linux) to run.  Most tests were performed using .NET framework 4.0 on two quad-core Xenon processors with 4 GB of RAM running 64-bit Windows 7 Enterprise.  Some testing with \socjttwo has been done on MNode1, a linux cluster running Red Hat Enterprise 6.1 Linux using Mono 3.2.1.
\begin{comment}
A version for the Cray
operating system is available upon request, as is the source code for
the DOS versions. This program should be cited as: Barckholtz, T. A.;
Miller, T. A.  {\it Int. Rev. Phys. Chem.}, {\bf 1998}, {\it 17},
435-524.
\end{comment}

\subsection{Program limitations.} \label{section:limitations}
\socjttwo, by design, suffers many, though not all, of the limitations of \socjt which are described below.

\begin{bulletlist}
\item \socjttwo cannot handle degeneracies greater than two; i.e., it
  does not work for the cubic point groups. It also may not
  work for molecules with a $C_4$ axis; see the discussion of these
  point groups in references \citen{tab4} and \citen{jttheory20}.
\item The program can only properly handle one type of \JT\ active
  mode, with respect to the values of $s_2$. Examination of
  Table 3 of reference \citen{tab4} shows that it is possible to have
  a state with more than one symmetry of quadratic linear \JT\ active
  modes. In this case, they may have a different value of
  $s_2$. However, only one value of $s_2$ is allowed as input in the
  program. The ramification of this is that the energies will be
  calculated accurately, but the Coriolis coupling constants will
  likely be erroneously computed. This case should be fairly rare, and
  I have not considered this possibility extensively.
\item The program has been extensively test against \socjt for the $C_{3v}$/$D_{3h}$ case, and
  is believed to be accurate for all other non-cubic point groups.
\end{bulletlist}

\section{The Jahn-Teller Effect} \label{section:jt}

Before describing the input and output of \socjttwo, we briefly summarize
the Jahn-Teller effect, which serves several purposes. The \JT\ effect
is over sixty years old, and numerous different approaches have been
taken in the analysis of the vibronic structure of \JT\ active
molecules. There thus exists a wide variety of notations and
nomenclatures for all of the different parameters and effects involved
in the problem. This section outlines our approach and summarizes the
most important aspects of the problem. For a full description, we
refer the reader to the masterwork on this problem, reference
\citen{tab4}. The appendix to this manual includes a table of all of
the different mathematical symbols used in this work, and, where 
appropriate, the corresponding input parameter to the \socjttwo program.

\subsection{Basis set.} The basis set used to compute the vibrational 
structure of Jahn-Teller states is a product of electronic, vibrational,
and spin functions. At the symmetric configuration of the nuclei, 
the electronic wavefunction is degenerate and we use the label
$\Lambda = \pm 1$ to distinguish between the 
two complex components of the $^2$E electronic wavefunction E$_\pm$. 
We multiply the electronic basis set by the harmonic oscillator basis
functions for the $p$ two-dimensional Jahn-Teller active modes and the
$3N-6-2p$ harmonic oscillator basis functions for the non-Jahn-Teller
active modes. The vibrational portion of the basis set is
characterized by the principal vibrational quantum number $v_i$ and
the angular vibrational quantum number $l_i$ for each \JT\ active mode.
To include spin-orbit coupling in the calculation,
a ket characterized by the projection, $\Sigma $, of ${\bf S}$ on the 
symmetry axis is appended to the basis set.

Only some vibrational modes of a Jahn-Teller active molecule will show
the effects of $k^{th}$-order \JT\ coupling. In the mammoth paper
describing this 
project, we derived a general method for determining which vibrational
modes will be \JT\ active. For a given vibrational mode of symmetry
$e_{s_v}$ and  a given electronic state of symmetry $E_{s_e}$, a value
for $s_k$ of either 0 or 1 can be chosen to satisfy the equation
\begin{equation}
\left( 2s_e + (-1)^{s_k } ks_v \right) \text{ mod } n=0,
\label{se and sv selection rule}
\end{equation}
which means the quantity $\left( 2s_e \pm ks_v \right) $
must be an integer multiple of $n$, where $n$ is the order of the
principal axis of the molecule. The only variable in equation (\ref{se
  and sv selection rule}) is $s_k$, and the values of $s_k$ ($k=1$ and 2)
are required input to \socjt . The reader should refer to Table 2 of
reference \citen{tab4} for guidance in choosing values for $s_1$ and
$s_2$. See also section \ref{section:limitations} for some
restrictions on these quantities.

\subsection{Hamiltonian.} The Hamiltonian for the molecule is the sum of a number of terms, 
\begin{equation}
\hat{\cal H}=\hat{\cal H}_{T}+\hat{V}+\hat{\cal H}_{SO},
\label{overall Hamiltonian}
\end{equation}
where $\hat{\cal H}_{T}$ is the kinetic energy of the nuclei. 
The sum of $\hat{\cal H}_T$ and the potential $\hat{V}$ define
the potential energy surface (PES). We refer the reader to our 
previous papers\cite{c6f6review,tab4} on this topic for the
terms of the power series expansion of the potential 
$\hat{V}$. For our
purposes here, it suffices to say that the potential has, in addition
to the standard harmonic oscillator terms for the degenerate modes,
terms linear and quadratic in the vibrational coordinates of the
degenerate modes that account
for linear and quadratic Jahn-Teller coupling. 
The experimentally observed spin-vibronic energy levels of an \XtildeE\
states can be viewed as the eigenvalues of the nuclear
motion defined on a PES determined by $\hat{V}$ and $\hat{\cal H}_{SO}$.

\subsection{PES and definition of customary Jahn-Teller parameters.} 
The customary parameters that are used to characterize the 
PES are defined in the following way. The spin-orbit 
Hamiltonian $\hat{\cal H}_{SO}$ is parameterized by the product $a\zeta _e$,
where $\zeta _e$ is the projection of the electronic orbital angular
momentum on the $C_3$ axis and $a$ is the spin-orbit coupling constant.
The remaining parameters of the PES can most easily be defined by noting 
that, in the limit $a\zeta _e\rightarrow 0$, the form of the potential
$\hat{V}$ along the $i^{th}$ normal coordinate is
\begin{eqnarray}
  &U_{i,\pm }= \frac12 \lambda _i \rho _i^2 \pm \rho _i k_i
   \left[ 1 + \frac{2g_{ii}\rho _i}{k_i}\cos 3\phi _i + 
   \frac{g_{ii}^2\rho _i^2}{k_i^2} \right]^{\frac12} &\\
  &\approx \frac12 \lambda _i \rho _i^2 \pm \left( k_i \rho _i + 
  g_{ii}\rho _i^2 \cos 3\phi _i \right) ,& 
\label{U, no spin orbit}
\end{eqnarray}
where in the last equality the expansion of the radical has been
truncated at terms quadratic in $\rho _i$. In these equations, cylindrical 
coordinates $\rho _i$ and $\phi _i$ have been used for i$^{th}$ degenerate
normal mode that is Jahn-Teller active. 
The energies of the minima and maxima along this coordinate are given by
\begin{eqnarray}
&E_{\min ,i} =-\frac{k_{i}^{2}}{2\lambda _{i}(1-K_{i})}=-\frac{D_{i}\omega
_{e,i}}{(1-K_{i})}\approx -D_{i}\omega _{e,i}(1+K_{i})&
\label{E min, no spin orbit} \\
&\rho _{\max ,i} =\frac{k_{i}}{\lambda _{i}(1+K_{i})};
\phi _{\max ,i} = \frac{\pi }{3}, \pi , \frac{5\pi}{3}&
\label{rho max, no spin orbit} \\
&E_{\max ,i} =-\frac{k_{i}^{2}}{2\lambda _{i}(1+K_{i})}=-\frac{D_{i}\omega
_{e,i}}{(1+K_{i})}\approx -D_{i}\omega _{e,i}(1-K_{i})\text{,}&
\label{E max, no spin orbit}
\end{eqnarray}
where $D_{i}$ is the linear Jahn-Teller coupling constant for the $i^{th}$ 
mode and $K_{i}$ is its quadratic Jahn-Teller coupling constant. Both 
of these coupling constants are dimensionless.

The energies of Eqs. \ref{E min, no spin orbit} and \ref{E
max, no spin orbit} are relative to the symmetric configuration, which 
is defined as the zero of energy. The depth, $\epsilon ^{(1)}$, of the moat is the
linear Jahn-Teller stabilization energy and is a direct measure of the net
effect the Jahn-Teller coupling has on the energy of the
molecule. From Eqs. \ref{E min, no spin orbit} and \ref{E max,
  no spin orbit}, the stabilization energy due to linear Jahn-Teller
coupling is obtained by setting $K_i=0$ and taking the difference,
which yields
\begin{equation}
\epsilon _i^{(1)} = D_i \omega _{e,i}. 
\label{def of epsilon1}
\end{equation}
The additional stabilization due to quadratic Jahn-Teller coupling in
the mode, $\epsilon _i^{(2)}$, is
\begin{equation}
\epsilon _i^{(2)} = D_i \omega _{e,i} K_i. \label{def of epsilon2}
\end{equation}
The barrier to pseudorotation about the moat is then $2D_i \omega
_{e,i} K_i$.

A common approximation is that the Jahn-Teller stabilization 
energy in the state is a sum of the Jahn-Teller effect in the individual 
modes. Under this assumption, the total Jahn-Teller stabilization energy
is a sum over the individual Jahn-Teller stabilization energies,
\begin{equation}
\epsilon _{total} = \sum\limits _i \left[ D_i \omega _{e,i} 
\left( 1 + K_i \right) \right] .
\end{equation}

When spin-orbit coupling is non-negligible, the stabilization energy 
along the $i^{th}$ coordinate is decreased by the presence of spin-orbit
coupling to\cite{tab4}
\begin{equation}
-\epsilon _i^{so}=
\left\{ 
\begin{array}{ll}
-D_{i}\omega _{e,i}+\frac{\left( a\zeta _{e}\right) ^{2}}{16D_{i}\omega
_{e,i}} & ,a\zeta _{e}<4D_{i}\omega _{e,i} \\ 
0 & ,a\zeta _{e}\geq 4D_{i}\omega _{e,i}
\end{array} 
\right.  \label{E min, with soc} 
\end{equation}
The total Jahn-Teller stabilization energy is then a sum over all of
the individual stabilization energies of Eq. \ref{E min, with soc}.

\subsection{The Jahn-Teller quantum numbers $j^{(k)}$}

As the Taylor expansion of the \JT\ Hamiltonian is increased, the
number of conserved quantum numbers is decreased. Elsewhere\cite{tab4}
we derived the following general form of the ``good'' \JT\ quantum
number, $j^{(k)}$ for the $k^{th}$-order term of the \JT\ Hamiltonian,
\begin{equation}
j^{(k)}=\frac{1}{k}l_t+ \frac12 (-1)^{s_k }\Lambda ,
\label{general form of j}
\end{equation}
where $s_k$ is chosen according to equation (\ref{se and sv selection
  rule}). The specific relationships between $j^{(k)}$, $l_t$, and
$\Lambda $ are given in Table 2 of reference \citen{tab4} for the
common point groups. The user's choice of $s_1$ and $s_2$ in the input
file dictate the definition of $j^{(1)}$ and $j^{(2)}$, according to
equation (\ref{general form of j}). 
In most circumstances the superscript $^{(k)}$ is
dropped, and a value of $k=1$ is assumed. This is the custom used in
the remainder of this manual and in the program itself.

\subsection{Eigenvectors.} The general form for the eigenfunctions 
$\left| j,n_{j},\alpha ,\Sigma \right\rangle $ is 
\begin{equation}
\left| j,n_{j},\alpha ,\Sigma \right\rangle =\sum_{i}\left( c_{i,n_{j},\Sigma }\left|
\Lambda _{i}\right\rangle 
\prod\limits_{m=1}^{p}\left| v_{m,i},l_{m,i}\right\rangle \left| \Sigma _i \right\rangle 
\right), \label{eigenvector notation}
\end{equation}
where the summation runs over all of the basis functions used in the
calculation. Each eigenvector $\left| j,n_{j},\alpha ,\Sigma \right\rangle $
has an associated eigenvalue $E_{j,n_{j},\Sigma }$. The notation $\left|
j,n_{j},\alpha ,\Sigma \right\rangle $ indicates which $j$-block the level
corresponds to and which eigenvector, $n_{j}$, it is from that symmetry
block (corresponding to a given $j$ -- different $j$ mod 3 when
quadratic coupling is included -- and $\Sigma$ combination), with the
lowest energy solution of each symmetry block being $n_{j}=1$.  
Because $j$
is not always a good quantum number, we have included into the ket the label 
$\alpha $, which is the symmetry species 
of the state. Note that there are now two subscripts on the quantum numbers $\nu $ and $l$
in the basis functions of equation (\ref{eigenvector notation}). 
The first, $m$, corresponds to which vibrational
mode the quantum number refers while the second, $i$, represents the basis
function to which the quantum number belongs. 

The quantum number $\Sigma $ is
included in the summation only when spin-orbit coupling is included in the Hamiltonian;
in its absence, equation (\ref{eigenvector notation}) becomes
\begin{equation}
\left| j,n_{j},\alpha \right\rangle \left| \Sigma \right\rangle =
\sum_{i}\left( c_{i,n_{j} }\left| \Lambda _{i}\right\rangle 
\prod\limits_{m=1}^{p}\left| v_{m,i},l_{m,i}\right\rangle  \right) 
\left| \Sigma \right\rangle . \label{eigenvector notation without sigma}
\end{equation}
In the two limits of small spin-orbit coupling or large Jahn-Teller coupling
the spin-vibronic wavefunction is approximately identical to the
vibronic wavefunction, i.e.,  
$\left| j,n_{j},\alpha \right\rangle \left| \Sigma \right\rangle \approx 
\left| j,n_{j},\alpha ,\Sigma \right\rangle $.
At these limits, the two components of the spin-orbit doublet have
identical vibronic wavefunctions and PES's. Depending on the choice of
input parameters (i.e., a zero or non-zero value of $a\zeta _e$), the
output of the eigenvectors will be in the form of either equation
(\ref{eigenvector notation}) or (\ref{eigenvector notation without sigma}).

\subsection{Ham reduction factor.} An important feature of the \socjt\
program is that it has the 
capability of directly including spin-orbit coupling along with \JT\
coupling in the Hamiltonian. Prior to this program, nearly all
Jahn-Teller calculations in the literature have added spin-orbit 
coupling to the linear Jahn-Teller Hamiltonian ``after the fact'' via a
formula initially derived by Child and Longuet-Higgins.\cite{jttheory9} The
formula is derived by taking the expectation value of $\hat{\cal H}_{SO}$ 
for the vibronic eigenfunction, computed without including $\hat{\cal H}_{SO}$
in the Hamiltonian: 
\begin{equation}
\left\langle \Sigma \right|
\left\langle j,n_{j},\alpha \right| \hat{\cal H}_{SO}
\left| j,n_{j},\alpha \right\rangle \left| \Sigma \right\rangle
=a\zeta _{e}d_{j,n_{j}}\Sigma \text{, where
  }d_{j,n_{j}}=\sum_i\Lambda 
_ic_{i,n_{j}}^{2}.  \label{ham parm definition}
\end{equation}
The parameter $d_{j,n_{j}}$ is often called the Ham reduction factor and is usually
not given with subscripts. However, because each
vibronic level has a unique value of $d$, we feel it is appropriate to
assign subscripts to this parameter to identify the eigenfunction to which
it corresponds. From this formula, the approximate spin-orbit
splitting, $\Delta E_{j,n_j}^{SO}$ of the $n_{j}^{th}$ energy level of
the $j^{th}$ symmetry block is  
\begin{equation}
\Delta E_{j,n_{j}}^{SO}= E_{j,n_j,\Sigma = +\frac12 } - 
E_{j,n_j,\Sigma = -\frac12 } = a\zeta _{e}d_{j,n_{j}}.  \label{azetad2}
\end{equation}
The quantity $d_{j,n_{j}}$ is contained in the output for each
eigenvalue and eigenvector computed. These values are printed even
when spin-orbit coupling or quadratic \JT\ coupling is included in the
calculation. In these cases, the Ham reduction factor may have little
relevance to the observed energy levels, and the actual computed
energies should be used instead of the energies calculated by equation
(\ref{azetad2}). 

\subsection{Coriolis and spin-rotation parameters.} 
One last quantity remains to be defined, and that is the Coriolis
coupling constant, which is defined by the Coriolis Hamiltonian,
\begin{equation}
\hat{\cal H}_{COR} = -2A \left( \hat{L}_z + \hat{G}_z \right)
\hat{N}_z .
\label{HCOR}
\end{equation}
As we discussed in detail elsewhere,\cite{tab4,tab11} the Coriolis
coupling has a strong dependence on the spin-orbit coupling, and is
quite closely related to the spin-rotation parameter $\epsilon
_{aa}$. We present only the results of our derivations of the
following equations and refer the reader to the original
paper\cite{tab4} for details. 

The expectation value $\zeta _t$ of  $\hat{\cal H}_{COR}$ over the
eigenfunction for a given degenerate vibronic level, in the absence of
spin-orbit coupling, is 
\begin{eqnarray}
\hat{\cal H}_{COR}
&=&-2A\left\langle j,n_{j},\alpha =e\right| \hat{L}_z + \hat{G}_z
\left| j,n_{j},\alpha =e\right\rangle \hat{N}_z   \label{Hcor evaluation line 1} \\
&=&-2A\zeta _{t} \hat{N}_z,  \label{Hcor evaluation line 2} \\
\text{where }\zeta _{t} &=&\sum_{i}\left[ c_{i,n_j}^{2}\left( \Lambda _{i}\zeta
_{e}+\sum\limits_{m=1}^{p}l_{m,i}\zeta _{m}\right) \right] ,
\label{Hcor evaluation line 3}
\end{eqnarray}
where $\zeta _{e}$ is the electronic orbital angular momentum and
$\zeta _{i}$ is the Coriolis coupling constant for the $i^{th}$
vibrational mode.

With non-zero spin-orbit coupling, equation (\ref{Hcor evaluation line
  3}) becomes 
\begin{eqnarray}
\hat{\cal H}_{COR}
&=&-2A\left\langle j,n_{j},\alpha =e,\Sigma \right| \hat{L}_z + \hat{G}_z
\left| j,n_{j},\alpha =e,\Sigma \right\rangle \hat{N}_z  \\ 
&=&-2A\zeta _{t}^\Sigma  \hat{N}_z,  \\
\text{where }\zeta _{t}^\Sigma  &=&\sum_{i}\left[ c_{i,n_j,\Sigma
    }^{2}\left( \Lambda _{i}\zeta
    _{e}+\sum\limits_{m=1}^{p}l_{m,i}\zeta _{m}\right) \right] .
\label{Hcor with spin}
\end{eqnarray}
The difference between the Coriolis constant for each spin component,
$\Delta \zeta _t^\pm $, is
\begin{equation}
\Delta \zeta _t = \zeta _t^+ - \zeta _t^-,
\label{delta zeta spin}
\end{equation}
where the signs correspond to the sign of $\Sigma = \pm \frac12 $. The
two Coriolis constants will be approximately related by
\begin{equation}
\zeta _t^\pm = \zeta _t^0 \pm \frac12 \Delta \zeta _t , \label{zetaspinrot}
\end{equation}
where $\zeta _t^0$ denotes the Coriolis coupling
constant that would result if there were no spin-orbit coupling; i.e.,
a Coriolis coupling constant corresponding to equation 
(\ref{Hcor evaluation line 3}).
As derived elsewhere,\cite{tab4} the difference in the two Coriolis
coupling constants is related to the spin-rotation interaction by the equality
\begin{equation}
\frac{\epsilon _{aa}^{2v}}{2A} = -\Delta \zeta _t ,
\label{deltazetaepsilonaa}
\end{equation}
where $A$ is the rotational constant about the primary axis of the molecule.

For each eigenvalue and eigenvector computed, a value of $\zeta _t$ is
computed by either equation (\ref{Hcor evaluation line 3}) or 
(\ref{Hcor with spin}), which allows the quantities $\Delta \zeta _t $
and then $\frac{\epsilon _{aa}^{2v}}{2A}$ to be computed.

\section{Input} \label{section:input}

The input file is organized into sets of namelist groups, each of
which is begun by a \&NAMELIST command and ended with a forward slash
\/, as in 
\begin{verbatim}
 &GENERAL 
  nmodes = 1
  AZETA = 950.
  MAXJ = 1.5
  TITLE = cdch3 
  /
\end{verbatim}
Within each \&NAMELIST the input variables are assigned their initial
values, and separated by returns, spaces or tabs. Each \&NAMELIST group is separated from
the previous by a '/'. C$\sharp$ does not suffer the same weaknesses of FORTRAN for file I/O
so the number of spaces and alignment of decimals for the input parameters is unimportant.
Where a boolean value is required \socjttwo checks for a T or TRUE (in upper or lower case)
and if that is not found the default value of FALSE is used. Any input files for \socjt will work
with \socjttwo however there are some capabilities in \socjt not included in \socjttwo such as 
computation of spectra and those sections will be ignored. The order of the variables in
the \&NAMELIST does not matter, nor does the order of the \&NAMELIST
groups in the input file itself.

The \&NAMELIST groups are separated by their function. There will be one each of
\&GENERAL, \&SOLVE\_INFO and \&IO\_INFO. There will be as many \&MODE\_INFO groups as there are active modes
(specified by the variable $nmodes$ in \&GENERAL). If any group is not included,
a default set of parameters will be used. The \&FIT\_INFO, \&SCAN and \&CROSS\_TERMS 
are only necessary to include when needed. Likewise, if more than one
\&NAMELIST group is included in the input file, only the first will be
used. 

BEWARE: There is only some error checking in the input file. It is
quite possible that the ``garbage in garbage out'' principle
applies. For example, values of ${\bf S}$ that are not either integer
or half-integer may cause the program to crash or give nonsensical
results.

\subsection{\&GENERAL}

The \&GENERAL namelist group sets the general parameters for the
calculation. The default values are

\begin{verbatim}
 &GENERAL 
  NMODES = 1
  TITLE = TITLE
  S = 0.5
  AZETA = 0.0
  FIT_AZETA = FALSE
  ZETAE = 1.0
  MAXJ = 7.5
  CALC_DERIV = FALSE
  USE_KAPPA_ETA = FALSE
  S1 = 0
  S2 = 1
  /
\end{verbatim}

\begin{description}

\item[NMODES] Number of Jahn-Teller active modes in the state. Integer.

\item[TITLE] Title for the calculation, up to 80 characters
  long. Does not need to be in quotes (they will be considered part of
  the name). 

\item[S] Value of the spin angular momentum for the state, must be
  zero, half-integer, or integer, although there is no check on this. Real.

\item[AZETA] The value of $a\zeta _e$ in a spin-orbit state. If
  $a\zeta_e$ is zero, then the value of $S$ does not matter. Real.

\item[FIT\_AZETA] Whether or not to fit $a\zeta _e$ in the fitting
  routines. Boolean.

\item[ZETAE] The value of $\zeta _e$ for the state, used only in the
  calculation of the Coriolis coupling constant. Real.

\item[MAXJ] The maximum value of $j$ to be used in the
  calculation. For linear Jahn-Teller coupling only, this is the
  maximum value of $j$ for which the diagonalizations will be
  performed. For quadratic Jahn-Teller coupling calculations, this is
  the maximum value of $j$ to be included in the matrices. For
  quadratic \JT\ coupling, maxj should be at least 7.5. This value
  must be half-integer; if something else is used, I believe the
  effective value becomes the closest half-integer value, rounding
  down. Real.

\item[CALC\_DERIV] Boolean variable that determines whether the
  derivatives of the energies with respect to the various parameters
  (vibrational frequencies, coupling constants, etc.) should be
  calculated. The calculation of the derivatives of the eigenvalues with
  respect to the parameters has probably not been adequately tested,
  and no guarantee is made that they are accurate. Boolean.
  
  \item[USE\_KAPPA\_ETA] Boolean variable that is true if $\kappa$ (KAPPA) and 
  $\eta$ (ETA) will be used for the linear and quadratic Jahn-Teller coupling
  terms instead of D and K. This is false by default and may be left out of the
  input file if D and K are to be used. There is a simple relationship between
  $kappa$ and $eta$ and D and K which was derived by John Stanton. Within
  \socjttwo these are converted to D and K. This is purely a matter of user convenience
  when $kappa$ and $eta$ would be easier to use. Boolean.

\item[s1] Value of s$_1$ according to equation (\ref{se and sv
    selection rule}). This choice has no bearing on the calculated
  energies of the spin-vibronic levels, only the relative phases of
  the electronic and vibrational contributions to the Coriolis
  coupling constant of each level. While the value should be either 0
  or 1, any even or odd number will work as if they were 0 or 1,
  respectively. Integer. 

\item[s2] Value of s$_2$ according to equation (\ref{se and sv
    selection rule}). See above, and section \ref{section:limitations}
  for a discussion of the limitations on this parameter.

\end{description}

\subsection{\&MODE\_INFO}

For each vibrational mode, a \&MODE\_INFO must exist, otherwise
default parameters are used that will cause spurious results for the
user. There must therefore be NMODES \&MODE\_INFO namelist groups in
the input file. The default values are

\begin{verbatim}
 &MODE_INFO
  MODEVMAX = 0
  MODEOMEGA = 0.0
  MODEWEXE = 0.0
  MODED = 0.0
  MODEK = 0.0
  FIT_OMEGA = FALSE
  FIT_D = FALSE
  FIT_K = FALSE
  FIT_WEXE = FALSE
  ISATYPE = FALSE
  MODEA_OMEGA = 0.0
  MODEZETA = 0.0
  /
\end{verbatim}

If using USE\_KAPPA\_ETA = TRUE in the \&GENERAL section, then replace MODED, MODEK, FIT\_D, and FIT\_K by the following.

\begin{verbatim}
  KAPPA = 0.0
  ETA = 0.0
  FIT_KAPPA = FALSE
  FIT_ETA = FALSE
\end{verbatim}

\begin{description}

\item[MODEVMAX] Maximum value of v for this vibrational mode. In
  general, the lower the vibrational frequency and the larger the \JT\
  coupling constants, the larger this number needs to be. In practice,
  a value never less than 2 is useful, even for the modes with very
  large frequencies and low coupling constants (such as C-H stretches
  often are). Integer.

\item[MODEOMEGA] Vibrational frequency, in \wn , for the mode. Real.

\item[MODEWEXE] Anharmonicity for the mode, in \wn . Real.

\item[MODED] Linear \JT\ coupling constant for the mode, as defined in
  equations (\ref{E min, no spin orbit}) to (\ref{E max, no spin
    orbit}). This value is usually considered to be positive. I have
  not tested the effect of a negative value of $moded$ in the
  program. Dimensionless, real.

\item[MODEK] Quadratic \JT\ coupling constant for the mode, as
  defined in equations (\ref{E min, no spin orbit}) to (\ref{E max, no spin
    orbit}). While D$_i$ is positive, K$_i$ can be either positive or
  negative. The choice has no effect on the calcualted energy levels,
  but does swap the symmetries of the $j=\frac{3}{2}$ levels split by
  the quadratic interaction. These symmetries are sometimes not able to be
  determined experimentally, in which case the sign of K$_i$ has
  no meaning. Dimensionless, real.

\item[FIT\_OMEGA,FIT\_D,FIT\_K,FIT\_WEXE,FIT\_KAPPA,FIT\_ETA] Whether to fit these
  parameters in the fitting routine.  All boolean.
  
\item[ISATYPE] Boolean value to indicate if this mode is a degenerate (default) or
  nondegenerate (A type). If TRUE, then the mode is treated a nondegenerate for the purposes
  of building the basis set and any values entered for D or K (ETA or KAPPA) are ignored. Boolean.

\item[MODEA\_OMEGA] The value of the vibrational frequency of this
  mode in the non-degenerate state to or from which electronic
  transitions occur. This parameter is used only in the calculation of
  the relative intensities of the vibrational progressions in the
  electronic spectra, and in the files generated to produce
  simulations of these spectra. Real, \wn .

\item[MODEZETA] The Coriolis coupling constant for this vibrational
  mode, used only in the calculation of the Coriolis coupling constant
  for the (spin-)vibronic level. Dimensionless, real.

\end{description}

\subsection{\&SOLVE\_INFO}

The \&SOLVE\_INFO namelist group contains parameters used in the
diagonalization routines. In general, the default values should be
adequate for the block Lanczos routine, except for M, which is the number of eigenvalues desired,
which the user must choose. 

There is the option of using either a block Lanczos routine (Underwood method) or a simple Lanczos routine. The block routine
uses full reorthogonalization and generates the eigenvectors during the routine
automatically. The benefits of this routine are that it is guaranteed to find all
of the eigenvalues with no spurious values and if the eigenvectors are requested
it does not take any extra time to do so.  The drawback of this routine is that it
may take up to 100x longer than the simple Lanczos routine. For the block routine
K\_FACTOR is the size of the blocks used, NOITS is the maximum number of iterations
that will run and TOL is the tolerance used to define when an eigenpair has converged.
When using the block routine, the runtime may be dependent upon K\_FACTOR and while
I have found 2 to be adequate in most cases a larger value may run faster.  For a 
larger K\_FACTOR less iterations will be required but they will take longer.  The routine
completes when either NOITS is exceeded or all eigenvalues requested converge to the 
specified tolerance.

For the simple Lanczos routine K\_FACTOR is not used and the other parameters described above
have slightly different uses. NOITS is the number of Lanczos iterations run, and therefore, the
size of the Lanczos matrix generated. This routine does not use any orthogonalization so some
eigenvalues will be repeats and others will be spurious values which do not correspond to actual
eigenvalues of the Hamiltonian. These duplicate and spurious values are removed after diagonalization
by a test. For this reason the M used should be larger than the number of eigenvalues actually
desired. How much larger depends on the number of iterations as more spurious and duplicate
eigenvalues will be generated as more iterations are run. TOL for the simple Lanczos is used
in the test to remove duplicate and spurious eigenvalues. Any eigenvalue within TOL of another
is removed as a duplicate and this is the same test used to remove spurious values. A value
of 10$^{-6}$ works for most cases but it may be necessary to use a smaller value.

Defaults are

\begin{verbatim}
 &SOLVE_INFO
  M = 10
  K_FACTOR = 2
  NOITS = 10000
  TOL = 0.0001
  PARVEC = 1
  PARMAT = 1
  PARJ = 2
  BLOCK_LANCZOS = F
  OLD_RANDOM = F
  /
\end{verbatim}

\begin{description}
\item The Following is for the Block Lanczos routine.

\item[M] Number of eigenvalues to find in each block. Integer.

\item[K\_FACTOR] The block Lanczos routine uses blocks with 
  K\_FACTOR columns. The larger K\_FACTOR is the fewer iterations
  the routine will take to converge but the longer each iteration
  will take to run. Not used in the simple Lanczos routine. Integer.

\item[NOITS] Maximum number of iterations the eigenvalue routines
  will perform for each block. If the calculation stops because it has
  reached $noits$, the output will include the eigenvalues and
  eigenvectors found to that point. This can then serve as a guide for
  how many iterations might be necessary. This is the number of Lanczos
  iterations in the simple Lanczos routine. Integer.

\item[TOL] This is the relative tolerance to which
  the eigenvalues are found, such that $\frac{\Delta \epsilon
    }{\epsilon } < $TOL. A value of TOL less than 0.0001 is highly
  recommended, as this will, in general, result in energies calculated
  to within 1 \wn . For the simple Lanczos a value not larger than 10$^(-6)$
  should be used. Real.
  
\item[PARVEC] This is the degree of parallelization to be used in
  the matrix-vector multiplactions in the Lanczos routines. In 
  practice a value of 2 is only useful for basis sets larger than
  a few hundered thousand basis functions. Otherwise it will run
  fastest with the default value of 1. Integer.

\item[PARMAT] This is the degree of parallelization to be used in
  the matrix generation routine for each j block. In practice, as long as there are,
  a sufficient number of processors, the matrix generation speed 
  will increase almost linearly with the value of PARMAT. Integer.

\item[PARJ] This is the degree of parallelization to be used for
  the different j blocks.  Because each j block will call a matrix
  generation routine and a diagonalization routine the total number
  of processors used will be PARJ times PARVEC/PARMAT. Integer.

\item[BLOCK\_LANCZOS] Boolean value to indicate if the block Lanczos
  routine should be used. Boolean.

\item[OLD\_RANDOM] Boolean value to indicate if the random number
  generator from \socjt should be used or the \bf{.NET} built in
  random number generator should be used. Typically fewer iterations
  are used in the block routine with the new random routine. Boolean.

\end{description}

\subsection{\&IO\_INFO}

The \&IO\_INFO namelist group contains Boolean variables that
indicate whether a particular piece of output is desired as well
as how the eigenvectors should be printed. Defaults are

\begin{verbatim}
 &IO_INFO
  PRINT_BASIS = FALSE
  PRINT_VEC = FALSE
  PRINT_MATRIX = FALSE
  EV_MIN = 0.2
  /
\end{verbatim}

\begin{description}

\item[PRINT\_BASIS] Whether or not to include in the output the basis
  set for each block. Boolean.

\item[PRINT\_VEC] Whether or not to include in the output the eigenvectors
  for each block. The eigenvalues, Ham reduction factors, and Coriolis
  constants are part of the output whether PRINT\_VEC is true or
  false. Boolean.

\item[PRINT\_MATRIX] Whether or not to include in the output the Hamiltonian
  matrix for each block. Boolean.
  
\item[EV\_MIN] The minimum value of the weight for a basis function to be 
  printed in the eigenvectors. Double.

\end{description}


\subsection{\&FIT\_INFO} \label{fitinfo}

The \&FIT\_INFO namelist group controls the fitting portion of \socjttwo
. See section \ref{section:fitting} for more information. The default values are

\begin{verbatim}
 &FIT_INFO
  FITFILE = fit.fit
  FTOL = 0.0
  XTOL = 0.0
  GTOL = 0.0
  MAXFEV = 25
  FACTOR = 0.001
 /
\end{verbatim}

\begin{description}

\item[FITFILE] The name of the file that contains the energy levels
  to be fit and their assignments.  See section \ref{section:fitting:file} for
  the formatting of this file. String.

\item[FTOL, XTOL, and GTOL] To quote from the lmder.f
  literature regarding these three parameters:
  \begin{verbatim}
  ftol is a nonnegative input variable. Termination occurs when both
the actual and predicted relative reductions in the sum of squares are
at most ftol. Therefore, ftol measures the relative error desired in
the sum of squares. 

  xtol is a nonnegative input variable. Termination occurs when the
relative error between two consecutive iterates is at most
xtol. Therefore, xtol measures the relative error desired in the
approximate solution. 

  gtol is a nonnegative input variable. Termination occurs when the
cosine of the angle between fvec and any column of the jacobian is at
most gtol in absolute value. Therefore, gtol measures the
orthogonality desired between the function vector and the columns of
the jacobian. 
 \end{verbatim}

 The smaller these three numbers are, the tighter the parameters will
 be converged. See section \ref{section:fitting} for more
 information regarding these parameters. All real.

\item[MAXFEV] Maximum number of iterations for the fitting
  procedure. Integer.

\item[FACTOR] Essentially the step size the fitting procedure takes
  between successive iterations. A value of FACTOR greater than 1 or
  so will almost invariably cause wild and useless results. A small
  step size will take longer to converge, and may converge to a
  solution that is a local minimum. Real.

\end{description}

\subsection{\&CROSS\_TERMS} The \&CROSS\_TERMS namelist group specifies
any coupling terms between two modes and whether they are to be fit.

\begin{verbatim}
 &CROSS_TERMS
  JT MODE 1 MODE 2 100.0
  FIT = FALSE
 /
\end{verbatim}

\begin{description}
\item[JT] The string JT should be first which says this is a Jahn-Teller type cross-term.
Next, the two modes coupled by this term should be given as 'MODE x MODE y'. 
The last term is the value of the cross-term between the two modes. Double.

\item[FIT] Boolean value indicating whether the cross-term on the preceding line
should be fit. This line is optional and has a default value of FALSE.

\end{description}

\subsection{\&SCAN} \label{scan}

The \&SCAN namelist is optional and is only needed if one or more parameters
are being scanned. Any number of parameters may be scanned simultaneously.

\begin{verbatim}
 &SCAN
  STEPS = 10
  MODE 1 D 0.0 0.1
  MODE 1 K 0.01 0.02
  MODE 2 OMEGA 540.0 -5.0
  CROSS 1 2 JT 0.01 2.0
 /
\end{verbatim}

\begin{description}
\item[STEPS] This indicates how many steps should be done in the scan.
Integer.

\item[MODE] Lines starting with MODE indicate which parameters are being 
scanned. The first value beyond MODE must be an integer which is the mode
whose parameter is being scanned. Modes are labeled numerically in the order
in which they are in the input file. The next value is a string which may be
OMEGA, WEXE, D or K and says which variable is being scanned. After that 
is a double value giving the starting value of the parameter. The final
item is a double giving the step size of the parameter each iteration. 
The step size may be positive or negative.

\item[CROSS] If cross-terms are to be scanned the line must start with 
CROSS. The next two values are integers indicating which modes are coupled.
JT indicates that this is a Jahn-Teller type coupling term (the only type
of cross-terms currently implemented). The last two elements are the starting
value and step size respectively.

\end{description}

When doing a scan all fit booleans are set to false automatically. It is important
that if fitting a cross-term or quadratic JT term their starting value should not
be exactly 0. Not doing so will cause the comparison of final results difficult and may
cause errors.

\section{Output} \label{section:output}

\subsection{Output of \socjttwo }

The description of the output file uses as its example the output of
the {\tt test1} input file contained in the file
distribution. Hopefully the examples and accompanying descriptions are
sufficient to explain the output. The name of the output file is {\tt
  filename.out}, where {\tt filename} is the name of the input file.

\subsubsection{Preamble}

The output of the main program \socjttwo begins with the time the
calculation began,
\begin{verbatim}
 It is 171236.280 on 19990805
\end{verbatim}
The time is given in the form {\tt hhmmss.\#\#\#} to signify the
hour, minute, seconds, and fraction of a second. The date is given in
the form {\tt yyyymmdd} for the year, month, and day.

Following a header, the \&GENERAL and \&MODE\_INFO namelist groups
from the input file are given. Some additional information regarding
the input parameters and PES are tabulated:
\begin{verbatim}
 A*zeta_e =      -25.347877587660860
 Parameters for each Jahn-Teller active mode:
 Mode #  V(min)   V(max)     Omega(E)    wexe    D       K        JTSE  Omega(A)
 
  1        0        5         573.00      .00    .023    .010    13.18    585.00
  2        0       10         263.00      .00    .435    .000   114.40    239.00
 
 Total linear Jahn-Teller Stabilization energy =   127.58
 Total quadratic Jahn-Teller Stabilization energy =      .13
 Total linear JTSE including spin-orbit coupling =   108.94
\end{verbatim}
The numbering of the modes in the table are based on the order of the
\&MODE\_INFO namelist groups in the input file. The numbering given in
the table will be the numbering of the vibrational modes for the rest
of the output file.

The column of the table entitled {\tt JTSE} is the Jahn-Teller
stabilization energy for the mode; i.e., it is the energy of equation
(\ref{def of epsilon1}), and does not include the effects of
spin-orbit or quadratic \JT\ coupling.

The next few lines regurgitate the remaining input namelist groups, 
 \&IO\_INFO, \&SOLVE\_INFO, \&SPECTRA, and all of the \&UV\_INFO
 groups. 

Lastly, a few sentences summarize the type of calculation being
performed,
\begin{verbatim}
 Quadratic JT Program
 Spin-orbit being added
\end{verbatim}

\subsubsection{Each $j$ block}

At this point, the output begins to cycle through all of the blocks of
the Hamiltonian, beginning with $j=\frac12 $ and working up to
$maxj$. Each block is begun by a header, such as
\begin{verbatim}
 ********************
 ********************
 **                **
 **     J =  .5    **
 **  Sigma =  -.5  **
 **                **
 ********************
 ********************
\end{verbatim}
followed by the number of basis functions in this block.

\paragraph{Basis set}
The next section of the output is the listing of each basis function
included in this block of the Hamiltonian, and is only printed if the
value of $print\_basis$ has been set to {\tt .true.}. The output is of
the form
\begin{verbatim}
Basis Fxn #  v(1)  l(1)  v(2)  l(2)  Lam  2*Sig
 
     1         0     0     1     1     1    -1
     2         0     0     3     1     1    -1
     3         0     0     5     1     1    -1
     4         0     0     7     1     1    -1
\end{verbatim}
and continues through all of the basis functions. The columns give the
principal quantum number $v_i$ and the vibrational angular quantum
number $l_i$. The column ``{\tt Lam}'' is the value of $\Lambda $ for
the basis set, and the column ``{\tt 2*Sig}'' is twice the value of
$\Sigma $. (I realize this is a funny way to do it, but it ensures
that the output is uniform for both integer and half-integer spin states.)

\paragraph{Hamiltonian matrix}
After the basis set, a line is given that indicates how many non-zero
matrix elements there are in this block of the Hamiltonian. This
number is actually the number of non-zero matrix elements in the lower
half of the matrix. If the value of $print\_matrix$ has been set to
{\tt .true.} then all of the non-zero matrix elements will be printed
out,
\begin{verbatim}
  Col #  Row #    Value     Col #  Row #    Value     Col #  Row #    Value 
      1      1    1049.00
      2      2    1575.00
  .
  .
  .
      1     99     245.31     11     99     122.89     99     99     886.00
      1    100     245.31      2    100     346.92     12    100     122.89 
      2    101     346.92      3    101     424.89     13    101     122.89 
      3    102     424.89      4    102     490.62     14    102     122.89 
\end{verbatim}
The column and row numbers correspond to the indices of the matrix,
which are the basis functions listed previously in the output. The
values are listed in units of \wn .

\paragraph{Matrix diagonalization information}
If the variable $print\_monit$ was set to {\tt .true.} in the input
file, a lot of extra lines are added to the output. This information
is included only for the purposes of diagnostics in the programming,
and $print\_monit$ should generally be set to {\tt .false} in the
input file.

\paragraph{Possible diagonalization errors}
If the diagonalization was not successful, an error message will be
given indicating what the problem was. For the most part, the only
error message that will be encountered in normal practice in the
message indicating the maximum number of iterations was exceeded. In
this case, the calculation should be resubmitted with a larger value
of $noits$. It may or may not help to include the eigenvalues and
eigenvectors that were found as initial guesses. Even if an error was
encountered, the eigenvalues and eigenvectors for the solutions that
were found will be listed.

\paragraph{Eigenvalues and eigenvectors}
Hopefully, though, the next lines in the output will be
\begin{verbatim}
 Underwood method completed successfully.
 Final results for j =  .5 and Sigma =  -.5
\end{verbatim}
(``Underwood'' is the type of diagonalization routine used.) The next
section of the output lists the eigenvalues that were found as
solutions,
\begin{verbatim}
Found 11 eigenvalues
--------------------
     649.146200
     979.415800
    1165.737000
    1253.750000
    1386.468000
    1487.378000
    1526.489000
    1745.356000
    1778.216000
    1792.343000
    1821.780000
\end{verbatim}
These eigenvalues are in units of \wn , and are relative to the
undistorted point of the PES being defined as the zero of energy. The
final portion of the output file is a list of all of the eigenvalues
found, with the zero of energy being set to the energy of the lowest
energy (spin-)vibronic solution.

If the value of $print\_vec$ was set to {\tt .true.} in the input
file, then a considerable amount of additional information about each
solution is included in the output:
\begin{verbatim}
 Eigenvalue      1 =     649.15
 Spin-orbit quenching parameter d =  -.1669613
 zeta_t = -.167* zeta_e  +   .016* zeta_ 1 +   .401* zeta_ 2 =   .215
 
 Eigenvector: (Only vectors with coefficient > 0.025 are shown)
 
     Coefficient  v(1)  l(1)  v(2)  l(2)   Lam  2*Sig
       .6185285     0     0     1     1     1    -1
       .1097540     0     0     3     1     1    -1
       .0255114     1    -1     2     2     1    -1
       .1402043     1     1     0     0     1    -1
       .0363902     1     1     2     0     1    -1
      -.7133587     0     0     0     0    -1    -1
      -.2546745     0     0     2     0    -1    -1
      -.0334868     0     0     4     0    -1    -1
      -.0801715     1    -1     1     1    -1    -1
      -.0411716     1     1     1    -1    -1    -1

\end{verbatim}
The Ham reduction parameter $d$ is computed for each level, assuming
that $\zeta _e$ is unity. The next line computes a value for the
Coriolis constant, $\zeta _t$, for the level, both as a formula of its
components and as a numerical value, based on the input values for
$\zeta _e$ and the $\zeta _i$. 

The eigenvector is given in tabular form, listing only those basis
functions for which the coefficient is greater than $\pm $0.025. The
columns are listed just as the basis functions are listed previously
in the output file.

\paragraph{Electronic spectra}
After the eigenvectors are listed, if desired, the process repeats
itself with the next $j$ block. However, if all of the necessary
calculations have been performed such that a requested electronic
spectrum can now be computed, the data for that UV-Vis spectrum is
included in the output at this point. For the electronic transition
intensities, the output is of the form 
\begin{verbatim}
 UV-Vis spectrum #           1
 
  (only lines that are > 1% of intensity of most intense transition
   are listed)
 
                             E state        A state vib qns
  Energy     Rel. Int.   j    Sigma    p      v(1)   v(2)   
 ---------  ----------- ---  -------  ---     ----   ----  
  36063.00        .27    .5    -.5    1        1      2
  35956.00        .23    .5    -.5    1        0      4
  35824.00       1.29    .5    -.5    1        1      1
  35824.00        .34    .5    -.5    1        1      1
  35717.00       2.42    .5    -.5    1        0      3
  35585.00       3.93    .5    -.5    1        1      0
  35478.00      12.92    .5    -.5    1        0      2
  35239.00      75.69    .5    -.5    1        0      1
  35000.00     100.00    .5    -.5    1        0      0
\end{verbatim}
This output is self-explanatory in nature. The transition energies are
calculated using the values of $modea\_omega$ in the input file and
the computed (spin-)vibronic energies.

\subsubsection{Calculation summary}
After the last $j$ block has been computed, the results of the
calculation are summarized.
\begin{verbatim} 
 Final results for all eigenvalues found.
 
 Eigenvalue    j   Sigma   n_j    zeta_t
        .00    .5   -.5     1      .1201
       4.44    .5    .5     1      .1392
     153.56   1.5   -.5     1      .1900 2.-fold degenerate
     195.84   1.5   -.5     2     -.2301 2.-fold degenerate
.
.
.
     842.58    .5   -.5    10     1.3277
     844.91    .5    .5    10     1.3497
 Program SOCJT exited properly.
 It is 171246.500on 19990805
\end{verbatim}
The comments ``{\it 2.-fold degenerate}'' serves simply as a reminder
that the two spin-components of the $j=\frac{3}{2}$ levels are not
split by spin-orbit coupling, but are mixed with each other.
The last line is simply the time and date the calculation finished.

\subsection{Fitting output}

When the non-linear least squares routines are used, \socjt\ is
executed once for each iteration of the fitting routine. At the end of
the fitting, output similar to the following is generated:
\begin{verbatim}
 Done with fitting routine.
 Energies were calculated   4 times.
 Derivatives were calculated   3 times.
 
 Fitting ended properly.
 Both actual and predicted relative reductions
   in the sum of squares are at most ftol.
 
 Final calculated parameters.
 ----------------------------
 A*zeta_e =      -25.347877587660860
 Parameters for each Jahn-Teller active mode:
 Mode #  V(min)   V(max)     Omega(E)    wexe    D       K        JTSE  Omega(A)
 
  1        0        5         603.32      .00    .378    .100   228.25    585.00
  2        0       10         269.96      .00    .439    .214   118.46    239.00
 
 Total linear Jahn-Teller Stabilization energy =   346.71
 Total quadratic Jahn-Teller Stabilization energy =    48.18
 Total linear JTSE including spin-orbit coupling =   346.20
 
 
 Final sum of squares of Delta E =     155.31
 Final rms error =  3.76
 
  Fit E     j  n_j Sig    Calc E       Err
    7.96    .5  1   .5      4.44      -3.52
  155.30   1.5  1  -.5    153.56      -1.74
  192.68   1.5  2  -.5    195.84       3.16
  298.22    .5  2  -.5    290.56      -7.66
  284.27    .5  2   .5    291.92       7.65
  376.90    .5  3   .5    374.50      -2.40
  379.14    .5  3  -.5    378.45       -.69
  439.50   1.5  3  -.5    441.05       1.55
  481.72   1.5  4  -.5    480.23      -1.49
  496.59    .5  4   .5    497.88       1.29
  499.06    .5  4  -.5    499.46        .40
\end{verbatim}

Following this table, all of the namelist groups are printed with the
final fit values, so that these lines can be copied into an input file
and the program started from these values.

\subsection{Auxiliary files} \label{section:outputaux}

There are several additional files that may be generated by \socjt :
{\tt filename.uv.\#.txt}, {\tt filename.basis.}$j.\Sigma $, and {\tt
  filename.vecs.}$j\Sigma $. The filenames are constructed by
appending brief notations to the {\tt filename} of the input file. For
the electronic transition intensites, the files are numbered according
to the \&UV\_INFO namelist groups. The basis set and vector files,
used in subsequent calculations by \socjt\ (as guesses to the
diagonalization routines) or by \etoe\ have a slightly more
complicated format. Following the appendation of {\tt .basis.} or {\tt
  .vecs.}, the value of $j$ is appended. If spin-orbit coupling was
included in the calculation, a ``{\tt m}'' or ``{\tt p}'' is appended
to indicate the sign of the value of $\Sigma $, which follows, for the
basis set or eigenvectors that are being written. While cumbersome,
these filenames allow for all of the required information to be stored
in a useable format.


\paragraph{Basis set and vector files}

If the formatting of these files is desired, please contact the
authors directly. These files are created so that the initial guess
functionality of \socjt\ works and so that the program \etoe\ has all
of the information it needs to calculate transition intensities
between two degenerate states.

\section{How to use SOCJT} \label{section:howto}

\subsection{Executing the program}
To execute \socjt , you can either open it up from the Windows
Explorer, create a shortcut to it for the Start menu, or go to an
MS-DOS prompt, change to the directory {\tt socjt.exe} is in, and type
{\tt socjt} at the prompt. The program immediately prompts the user
with the following question,
\begin{verbatim}
What is the input filename?
\end{verbatim}
Only the first 25 characters are actually used. The
filename should be the name of the input file. The names of all the
other files generated by \socjt , such as {\tt filename.out} for the
output file. Thus, it is probably not useful to name the input file
with a {\tt .inp} appended to it, as the other files will include the
``{\tt .inp}'' as part of their file names. All of the output and
auxiliary files that are generated are plain text files and can be
viewed with any standard text editor. There are no binary files
associated with \socjt .

\subsection{Execution times}
The time required for execution scales exponentially with the size of
the basis set. It is recommended that the user perform preliminary
calculations with smaller basis sets, and then work up to bigger basis
sets. The block-Lanczos routine (from \socjt) can take more than 100
times longer than the simple Lanczos routine written for \socjttwo\ so
it is recommended to use the simple Lanczos whenever possible and only
use the block routine to double check results. For example, a quadratic JT problem with $\sim$8800 basis functions took 180 s using the block Lanczos 
algorithm while it took only 2.7 s using the simple Lanczos. Hamiltonian
generation times scale quadratically with basis set size and may represent
the majority of execution time for large basis sets. For example, a problem with $\sim$450,000 basis functions took $\sim$1400 s to generate (using PARMAT = 4, PARJ = 2) the matrix but only $\sim$120 s to diagonalize with the simple Lanczos algorithm. All time tests were run on a machine with duo quad-core Intel Xeon processors at 2.6 GHz with 6 GB RAM. A final note is that execution times for the simple Lanczos routine increase, sometimes dramatically, when eigenvectors are requested. This is because, unlike the block Lanczos routine which automatically generates eigenvectors, they must be explicitly calculated by transforming the eigenvectors of the Lanczos matrix to those of the Hamiltonian by multiplying them by the Lanczos vectors. This means you have M matrix vector products of a matrix with dimension N (the size of the basis set) x NOITS times a vector of size N. 

\subsection{Recommendations on input parameters}
There are a few general recommendations regarding the choice of basis
set. First, in general, the larger the value of either $D_i$ or $K_i$,
the larger that mode's value of $MODE\_VMAX$ should be. This result is
fairly obvious. Second, the smaller the frequency $\omega _{e,i}$ is,
the larger the basis set should be. This result is not directly
obvious, but is derived from the experimental realization that most
information is available for the lower energy spin-vibronic levels,
and these levels will be dominated by the vibrational modes with low
frequencies. It is also important to vary the $MAXJ$ parameter, especially
for cases with strong JT coupling. For quadratic JT calculations a $MAXJ$
value of at least 7.5 should be used but a larger basis set may
be necessary.

Lastly, and most importantly, it is important to recognize that the
choice of a finite basis set is a potentially severe
approximation. Thus, it is very important that a series of
calculations needs to be performed, with increasing size of the basis
set. The calculations should have converged to the desired accuracy,
although in practice a few \wn \ is as close as they will
converge. For fitting spectra, most calculations can be run with only
moderately sized basis sets. As the improvement of the fit to the
experimental data improves, the basis set can be slowly increased.

\subsection{Degeneracies}
One subtlety that is often not appreciated is that every single level
is at least doubly degenerate. However, we only calculate one spin
component for each energy. To make things simple, we have calculated
only those levels with positive $j$. There is of course a degenerate
component, but we neglect it. See equation 76 of reference \citen{tab4}.

\subsection{Negative eigenvalues} \label{section:negeigs}
Because the eigenvalue-finding routines are specialized for a
type of matrix known as sparse, Hermitian, positive-definite,
trouble can result if an eigenvalue becomes negative. How can an
eigenvalue be negative? Remember that the zero of energy is the
``undistorted'' point of the PES, and that in the absence of \JT\
coupling the value of the lowest energy eigenvalue is the sum of the
vibrational frequencies of the mode. (Because of the degeneracies of
the modes, it is the sum of the frequencies rather than the sum of
one-half of the frequencies. The frequencies of only the \JT\ active
modes are used in the calculation.) \JT\ coupling decreases the
energy of the lowest level, and if the coupling constant(s) are
large enough, than in the definition of zero energy given above, the
energy of this level can actually become negative. In this case the
program will crash. The solution is to add an extra \JT\ active
vibrational mode to the problem that has a very large vibrational
frequency (10 000 \wn\ usually is more than sufficient) with zero
\JT\ coupling constants. The value of $modevmax$ for this mode
should be 1. This has the effect of increasing the diagonal
Hamiltonian matrix elements by 10 000 \wn , which is equivalent to
redefining the zero of energy to be 10 000 \wn . In only the rarest
cases will the energy of the lowest eigenvalue fall negative. In
these cases, a few test calculations should be run to ensure that
the added, spurious vibrational mode has no effect on the actually
calculated vibrational spacings. This appears to be a problem only for
the Cray version of the program; the DOS version has no problem with
negative eigenvalues.

\subsection{Non-linear least squares fitting} \label{section:fitting}

If any of the parameters $fit_azeta$, $fit_omega$, $fit_d$, $fit_k$,
or $fit_wexe$ are true, then the fitting routines will be executed. If
they are all false, then the eigenvalues will be computed only once,
and the program will be terminated. The fitting routines invoke a
non-linear least squares algorithm (written by so-and-so, downloaded
from somewhere) to optimize the input parameters. The fitting
procedures use as their starting point the values of $a\zeta _e$,
$\omega _{e,i}$, and so on that are given in the input file.

It is important to note that for most realistic cases, there is
probably not one unique ``best fit'' of the experimental data. The
multimode \JT\ problem is extremely complicated, and it is quite
likely that a number of ``local minima'' exist that can fit the data
reasonably well. Therefore, the choice of input parameters will
strongly influence the fitting results. We recommend the use of \ai\
calculations to guide the choice of vibrational frequencies, linear
\JT\ coupling constants, and spin-orbit coupling constant. See
reference \citen{tab8} for more details of \ai\ calculations of the
\JT\ surface.

\subsubsection{The format of $fitfile$} \label{section:fitting:file}

An additional file, named $fitfile$, is required. It contains a list
of the eigenvalues and quantum number assignments of the energy levels to
be fit. These energies are all relative to the ``vibrationless''
energy level being defined as the zero of energy. This file, a fixed
format file, is of the format 
\begin{verbatim*}
11
    7.96   0.5  1  0.5
  155.30   1.5  1 -0.5
.
.
.
  496.59   0.5  4  0.5
  499.06   0.5  4 -0.5  
\end{verbatim*}
The first line of the file contains the number of energy levels to be
fit, in this case 11.  There are then that many lines following with
the energy, $j$ value, $n_j$, and (if $a\zeta _e $ is non-zero) the
value of $\Sigma $.  Each line is of the format
\begin{verbatim}
format(f8.2,2x,f4.1,1x,i2,1x,f4.1)
\end{verbatim}
for $a\zeta _e$ non-zero, or
\begin{verbatim}
format(f8.2,2x,f4.1,1x,i2)
\end{verbatim}
for $a\zeta _e$ equal to zero.  The three ``quantum numbers'' $j$,
$n_j$, and $\Sigma $ define each unique energy level, and can be found
at the end of the output of a \socjt\ run.


\bibliographystyle{achemso_local}
\bibliography{organometallics,socjt,methoxy,tab,benzenes}

\end{document}

